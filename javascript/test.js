!function(){function t(t,n){this.set(t,n)}function n(){this.node=document.createElement("div"),this.node.id=x++,this.position=p.create(),this.rotation=p.create(),this.F=new t}function e(){n.call(this),this.i=[],this.color=y.splice(0,1)[0],y.push(this.color)}function i(t,e,i){n.call(this),this.$=t,this.ba=e,this.color=i,this.node.className="light"}function o(t,e,i,o){n.call(this),this.node.className="line",this.length=t,this.color=e,i&&this.setStart(i),o&&this.setEnd(o)}function a(){this.position=p.create(0,0,0),this.direction=p.create(0,0,-1)}function r(t,e,i,o,a){n.call(this),this.s=t,this.width=e,this.height=i,this.S=a,this.qa=!0,this.ca=!1!==o,this.node.className="plane",this.w={g:p.create(0,0,1),a:p.create(0,0,1),h:p.create(0,0,1),d:p.create(0,0,1)}}function s(){e.call(this),this.node.className="assembly"}function c(t,n){this.node=document.createElement("div"),this.node.className="viewport",this.I=document.createElement("div"),this.I.className="camera",this.u={position:p.create(0,0,0),rotation:p.create(0,0,0)},this.A=new s,this.node.appendChild(this.I),this.I.appendChild(this.A.node),t.appendChild(this.node),this.Z(n||700)}function d(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")}function h(t){function n(){s.call(this)}function e(t,n,e,i){s.call(this),this.add(new r({src:t.src},n,e),0,0,i/2,0,0,0),this.add(new r({src:t.src},n,e),0,0,-i/2,0,180,0),this.add(new r({src:t.src},i,e),n/2,0,0,0,90,0),this.add(new r({src:t.src},i,e),-n/2,0,0,0,270,0),this.add(new r({src:t.src},n,i),0,-e/2,0,90,0,0),this.add(new r({src:t.src},n,i),0,e/2,0,270,0,0)}function o(t,n,e,i){s.call(this);for(var o=Math.PI/i*2,a=Math.tan(Math.PI/i),c=n*Math.tan(Math.PI/i),d=0;d<i;d++){var h=Math.sin(o*d)*n/2,u=Math.cos(o*d)*n/2,f=Math.atan2(h,u),y=new r({src:t.src,x:c*(i-d),ra:c},c+1.5,e);y.w.d=y.w.g=p.create(-a,0,1),y.w.h=y.w.a=p.create(a,0,1),this.add(y,h,0,u,0,l.R(f),0)}}function a(){e.call(this,{src:"images/crate.jpg"},150,150,150)}function c(){o.call(this,{src:"images/can.png"},100,196,12),this.add(new r({src:"images/can.png",x:0,y:196,ra:102,Aa:102,la:!0},102,102,!1),0,-98,0,90)}n.prototype=s.prototype,e.prototype=s.prototype,o.prototype=s.prototype,a.prototype=new s,c.prototype=s.prototype;for(var d=new n,h=-1;1>=h;h++)d.add(new r({src:"images/wall.jpg"},2e3,700),0,-350,-700,0,0,0);for(d.add(new r({src:"images/wall.jpg"},1e3,700),-1e3,-350,-200,0,90,0),d.add(new r({src:"images/tile.jpg"},4e3,4e3,!1),0,0,0,90,0,0),d.add(new r({src:"images/cloud.jpg"},4e3,4e3,!1),0,-1500,-200,270,0,0),d.add(new r({src:"images/wall.jpg"},1e3,500),40,-240,1500,0,90,0),d.add(new r({src:"images/wall.jpg"},1e3,500),40,-240,1500,0,270,0),d.add(new r({src:"images/door.gif"},250,250),-250,-700,2e3,0,180,0),d.add(new r({src:"images/wall.jpg"},1e3,500),-750,-240,1500,0,90,0),d.add(new r({src:"images/wall.jpg"},1e3,500),-750,-240,1500,0,270,0),d.add(new a,-800,-75,-470),d.add(new a,-820,-225,-380,0,15),d.add(new a,-850,-75,-270,0,-15),d.add(new c,-800,-98,1230,0,190,0),d.add(new c,100,-98,1230,0,190,0),d.add(new i(200,1,{r:255,L:110,a:50}),-150,-630,330),d.add(new i(85,.5,{r:255,L:140,a:0}),-170,-820,840),h=0;10>h;h++)d.add(new r({src:"images/tile.jpg",y:100*h},800,50),-350,50*-h-25,50*h+1195,0,180),d.add(new r({src:"images/tile.jpg",y:100*h+50},800,50),-350,50*-h-50,50*h+1220,90);d.add(new i(105,1,{r:128,L:255,a:0}),70,-600,-400),(h=new n).add(new r({src:"images/tile.jpg"},700,400),-700,0,900,90,0,0),h.add(new r({src:"images/wall.jpg"},4e3,1900),-200,-300,950,0,180,0),h.add(new r({src:"images/wall.jpg"},1700,2e3),500,-300,0,0,270,0),h.add(new i(125,1,{r:128,L:178,a:255}),280,-400,-100),t.add(d,100,0,0),t.add(h,600,-500,1050)}var u=!0,p={create:function(t,n,e){return{x:t||0,y:n||0,z:e||0}},add:function(t,n){return{x:t.x+n.x,y:t.y+n.y,z:t.z+n.z}},sub:function(t,n){return{x:t.x-n.x,y:t.y-n.y,z:t.z-n.z}},Ba:function(t,n){return{x:t.x*n.x,y:t.y*n.y,z:t.z*n.z}},wa:function(t,n){return{x:t.x/n.x,y:t.y/n.y,z:t.z/n.z}},o:function(t,n){return{x:t.x*n,y:t.y*n,z:t.z*n}},H:function(t,n){return{x:t.x/n,y:t.y/n,z:t.z/n}},l:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},c:function(t,n){return t.x*n.x+t.y*n.y+t.z*n.z},ea:function(t,n){return{x:t.y*n.z-t.z*n.y,y:t.z*n.x-t.x*n.z,z:t.x*n.y-t.y*n.x}},normalize:function(t){return p.H(t,p.l(t))},sa:function(t,n){return Math.acos(p.c(t,n)/(p.l(t)*p.l(n)))},K:function(t){return{x:t.x,y:t.y,z:t.z}},xa:function(t,n){return t.x===n.x&&t.y===n.y&&t.z===n.z}},l={R:function(t){return 57.2957795*t},G:function(t){return.0174532925*t},v:function(t,n){var e=l.G(n.x/2),i=l.G(n.y/2),o=l.G(n.z/2),a=Math.cos(e),r=Math.cos(i),s=Math.cos(o),e=Math.sin(e),i=Math.sin(i),c=Math.sin(o),o=a*r*s+-e*i*c,d=e*r*s- -a*i*c,h=a*i*s+e*r*-c,a=a*r*c- -e*i*s;return{x:t.x*(1-2*(h*h+a*a))+2*t.y*(d*h-a*o)+2*t.z*(d*a+h*o),y:2*t.x*(d*h+a*o)+t.y*(1-2*(d*d+a*a))+2*t.z*(h*a-d*o),z:2*t.x*(d*a-h*o)+2*t.y*(a*h+d*o)+t.z*(1-2*(d*d+h*h))}},J:function(t,n){var i=[];if(t instanceof e)for(var o=0;o<t.i.length;o++)i=i.concat(l.J(t.i[o],n));else t instanceof n&&i.push(t);return i},Y:function(t,n,e,i){e=p.sub(e,t),n=p.sub(n,t);var o=p.sub(i,t);t=p.c(e,e),i=p.c(e,n),e=p.c(e,o);var a=p.c(n,n);return n=p.c(n,o),o=1/(t*a-i*i),a=(a*e-i*n)*o,t=(t*n-i*e)*o,0<=a&&0<=t&&1>a+t},ya:function(t,n,e,i,o){var a=p.c(i,p.sub(n,t));return 0<p.c(i,p.sub(o,e))?p.add(t,p.o(p.normalize(p.sub(n,t)),a)):t},ga:function(t,n,e,i){return e=-p.c(i,e),e=p.c(i,t)+e,i=p.c(i,n),0===i?null:p.add(t,p.o(n,-e/i))},U:function(t,n,e,i){var o=p.sub(e,t);e=p.sub(n,t);var a=p.l(e);return e=p.normalize(e),0>(o=p.c(e,o))?i?t:null:o>a?i?n:null:(e=p.o(e,o),p.add(t,e))},fa:function(t,n,e,i,o){return t=l.U(t,n,o,!0),e=l.U(n,e,o,!0),p.add(n,p.add(p.sub(t,n),p.sub(e,n)))},Da:function(t,n,e,i,o){var a=Math.max(t.x,n.x,e.x,i.x),r=Math.min(t.y,n.y,e.y,i.y),s=Math.max(t.y,n.y,e.y,i.y),c=Math.min(t.z,n.z,e.z,i.z),d=Math.max(t.z,n.z,e.z,i.z);return Math.min(t.x,n.x,e.x,i.x)>o.x&&a<o.x||r>o.y&&s<o.y||c>o.z&&d<o.z},pa:function(t,n,e,i,o){return l.Y(t,n,e,o)||l.Y(t,e,i,o)},T:function(t){var n=new a,e=l.J(t,i),s=l.J(t,r);l.J(t,o).forEach(function(t){t.parent.remove(t)}),s.forEach(function(t){delete t.O,delete t.m;var n=t.ha(),e=p.sub(n[1],n[0]),i=p.sub(n[2],n[1]);t.g=n[0],t.a=n[1],t.h=n[2],t.d=n[3],t.M=p.normalize(p.ea(e,i)),t.W=n[4],t.X=n[5],t.oa=n[6],t.Ca=n[7]}),e.forEach(function(t){var e,i,o=0,a=0,r=0,c=0,d=[],h=100+10*t.$,f=t.D(),y=p.create(t.color.r,t.color.L,t.color.a),x=s.filter(function(t){var n=l.fa(t.g,t.a,t.h,t.d,f),e=p.sub(f,n),i=p.l(e);if(t.ta=n,t.C=i,t.c=p.c(t.M,p.normalize(e)),i<=h)return t.ca&&d.push({g:t.g,a:t.a,h:t.h,d:t.d,M:t.M,C:t.C,na:p.create(Math.min(t.g.x,t.a.x,t.h.x,t.d.x),Math.min(t.g.y,t.a.y,t.h.y,t.d.y),Math.min(t.g.z,t.a.z,t.h.z,t.d.z)),ma:p.create(Math.max(t.g.x,t.a.x,t.h.x,t.d.x),Math.max(t.g.y,t.a.y,t.h.y,t.d.y),Math.max(t.g.z,t.a.z,t.h.z,t.d.z)),S:!1}),!0});d.sort(function(t,n){return t.C<n.C?-1:1});for(var m=0;m<x.length;m++)if(0<(e=x[m]).c){var g=Math.ceil(e.width/8)+1,w=Math.ceil(e.height/8)+1,v=p.H(p.sub(e.a,e.g),g),z=p.H(p.sub(e.h,e.a),w),M=p.H(p.sub(e.X,e.W),g),b=p.H(p.sub(e.X,e.oa),w);e.m||(e.m=[]);for(var F=0;F<w;F++){e.m[F]||(e.m[F]=[]);for(var j=0;j<g;j++){i=e.g,i=p.add(i,p.o(v,j)),i=p.add(i,p.o(z,F));var k=p.sub(f,i),A=p.l(k),C=p.normalize(k),k=255;if(o++,k=p.add(e.W,p.add(p.o(b,F),p.o(M,j))),k=Math.max(p.c(k,C),0),k=Math.max(0,1-A/h)*k*255*t.ba,e.qa&&A<=h)for(n.position=p.add(i,p.o(C,8)),n.C=A-8,n.direction=C,i=d.length,A=0;A<i;A++)if(C=d[A],n.ia(C.na,C.ma)){if(a++,n.ja(C.g,C.a,C.h,C.d,C.M)){k=0,c++;break}r++}u?e.m[F][j]=p.add(e.m[F][j]||p.create(),p.o(y,k/255)):(k=Math.min(255,(e.m[F][j]||k)+k),e.m[F][j]=k)}}}})}},f=function(){var t=document.documentElement.style,n=void 0!==t.WebkitTransform&&"-webkit-"||void 0!==t.MozTransform&&"-moz-"||void 0!==t.transform&&"";return u&=void 0!==t.backgroundBlendMode,{P:function(){return"position: absolute;left:50%;top:50%;"+n+"transform-style:preserve-3d;"},size:function(t,n){return"width:"+t.toFixed(2)+"px;height:"+n.toFixed(2)+"px;margin-left:"+-(t/2).toFixed(2)+"px;margin-top:"+-(n/2).toFixed(2)+"px;"},translate:function(t,e,i,o,a,r,s,c){return n+"transform:translate3d("+t.toFixed(2)+"px,"+e.toFixed(2)+"px,"+i.toFixed(2)+"px)rotateX("+o.toFixed(2)+"deg)rotateY("+a.toFixed(2)+"deg)rotateZ("+r.toFixed(2)+"deg)skewX("+(s||0)+"deg)skewY("+(c||0)+"deg);"},origin:function(t,e,i){return n+"transform-origin:"+t.toFixed(2)+"px "+e.toFixed(2)+"px "+i.toFixed(2)+"px;"},aa:function(t){return t?"":n+"backface-visibility:hidden;"},perspective:function(t){return n+"perspective:"+t+"px;"},za:function(t){for(var n=0,e=0;e<m.length;e++)var i=m[e],i=p.l(p.add(i.D(),t))/(100+6*i.$),n=Math.max(n,1-i);return n},da:function(t){return g(t.m)},s:function(t){var e=[],i=[],o=[],a=[],r="",s=f.da(t);return s&&("-"==s.charAt(0)?e.push(s):e.push("url("+s+")"),i.push("100% 0%"),o.push("0 0"),a.push("multiply")),e.push("url("+t.s.src+")"),i.push("auto"),o.push((t.s.x||0).toFixed(2)+"px -"+(t.s.y||0).toFixed(2)+"px"),t.s.la&&(r+=n+"mask-image:url("+t.s.src+");"+n+"mask-position:"+(t.s.x||0).toFixed(2)+"px -"+(t.s.y||0).toFixed(2)+"px;"),e.length&&(r+="background:"+e.join()+";"),o.length&&(r+="background-position:"+o.join()+";"),i.length&&(r+="background-size: "+i.join()+";"),u&&a.length&&(r+="background-blend-mode: "+a.join()+";"),r},clone:function(t){var n;if(t instanceof s&&(n=new s),t instanceof r&&(n=new r(t.ua,t.width,t.height,t.position.x,t.position.y)),n&&n.i)for(var e=0;e<t.i.length;e++)n.add(f.clone(t.i[e]));return n}}}();t.prototype={set:function(t,n,e){1==arguments.length?this.set(t.x,t.y):(this.x=t||0,this.y=n||0)}};var y="#f00 #f80 #ff0 #8f0 #0f0 #0f8 #0ff #08f #00f #80f #f0f #f08".split(" "),x=0,m=[];n.prototype={update:function(){setTimeout(function(){this.node.style.cssText=this.j()}.bind(this)),delete this.N},j:function(){return f.P()+f.translate(this.position.x,this.position.y,this.position.z,this.rotation.x,this.rotation.y,this.rotation.z,this.F.x,this.F.y)},clone:function(){return f.clone(this)},D:function(){if(this.N)return this.N;for(var t=this,n=p.create(0,0,0);t;)n=p.add(n,t.position),t=t.parent;return this.N=n}},e.prototype={update:function(t){if(n.prototype.update.call(this),t)for(t=0;t<this.i.length;t++)this.i[t].update(!0)},add:function(t,n,e,o,a,r,s,c,d){return t.parent&&t.parent.remove(t),void 0!==n&&(t.position.x=n),void 0!==e&&(t.position.y=e),void 0!==o&&(t.position.z=o),void 0!==a&&(t.rotation.x=a),void 0!==r&&(t.rotation.y=r),void 0!==s&&(t.rotation.z=s),void 0!==c&&(t.F.x=c),void 0!==d&&(t.F.y=d),t.parent=this,this.i.push(t),this.node.appendChild(t.node),t instanceof i&&m.push(t),t},remove:function(t){for(var n=0;n<this.i.length;n++)if(this.i[n]===t)return t.parent=null,t.node.parentNode.removeChild(t.node),this.i.splice(n,1),t},clone:n.prototype.clone,j:n.prototype.j},i.prototype={j:n.prototype.j,clone:n.prototype.clone,update:n.prototype.update,D:n.prototype.D},o.prototype={j:function(){return"width:"+this.length.toFixed(2)+"px;height:1px;background:"+this.color+";"+f.origin(0,0,0)+n.prototype.j.apply(this)},clone:n.prototype.clone,update:n.prototype.update,setStart:function(t){this.position=p.create(t.x,t.y,t.z)},setEnd:function(t){t=p.sub(t,this.position),this.length=p.l(t),this.rotation=p.create(0,l.R(-Math.atan2(t.z,t.x)),l.R(Math.asin(t.y/this.length)))}},a.prototype={ja:function(t,n,e,i,o){if(o=l.ga(this.position,this.direction,t,o)){var a=p.sub(o,this.position);if(0<p.c(a,this.direction)&&p.l(a)<=this.C&&l.pa(t,n,e,i,o))return o}return null},ia:function(t,n){var e,i=this.position,o=this.direction,a=(t.x-i.x)/o.x,r=(n.x-i.x)/o.x;a>r&&(e=r,r=a,a=e);var s=(t.y-i.y)/o.y,c=(n.y-i.y)/o.y;return s>c&&(e=c,c=s,s=e),!(a>c||s>r)&&(s>a&&(a=s),c<r&&(r=c),s=(t.z-i.z)/o.z,i=(n.z-i.z)/o.z,s>i&&(e=i,i=s,s=e),!(a>i||s>r))}},r.prototype={j:function(){return f.size(this.width,this.height)+f.aa(this.S)+f.s(this)+n.prototype.j.apply(this)},ha:function(){if(this.O)return this.O;var t,n;t=this.width/2|0,n=this.height/2|0;for(var e=Math.tan(l.G(this.F.x)),i=Math.tan(l.G(this.F.y)),o=p.create(-t-n*e,-n-t*i,0),a=p.create(+t-n*e,t*i-n,0),r=p.create(+t+n*e,+n+t*i,0),e=p.create(n*e-t,+n-t*i,0),i=this,s=p.K(this.w.g),c=p.K(this.w.a),d=p.K(this.w.h),h=p.K(this.w.d);i;)t=i.rotation,n=i.position,o=p.add(l.v(o,t),n),a=p.add(l.v(a,t),n),r=p.add(l.v(r,t),n),e=p.add(l.v(e,t),n),s=l.v(s,t),c=l.v(c,t),d=l.v(d,t),h=l.v(h,t),i=i.parent;return this.O=[o,a,r,e],[o,a,r,e,s,c,d,h]},clone:n.prototype.clone,update:n.prototype.update,D:n.prototype.D},s.prototype=e.prototype,c.prototype={Z:function(t){this.perspective=t,this.node.style.cssText=f.perspective(t)},update:function(){this.I.style.cssText=f.P()+f.translate(0,0,this.perspective,this.u.rotation.x,this.u.rotation.y,this.u.rotation.z),this.A.node.style.cssText=f.P()+f.translate(this.u.position.x,this.u.position.y,this.u.position.z,0,0,0)}};var g=function(){var t=document.createElement("canvas"),n=t.getContext("2d");return function(e){e||(e=[[0]]);var i=e.length,o=e[0].length,a=n.createImageData(o,i);t.height=a.height,t.width=a.width;var r=a.data,s=0;if(u)for(var c=0;c<i;c++)for(var d=0;d<o;d++){var h=e[c][d];10<i&&10<o&&(0<c&&(e[c-1][d].x<h.x+10&&(h.x=e[c-1][d].x/2+h.x/2),e[c-1][d].y<h.y+10&&(h.y=e[c-1][d].y/2+h.y/2),e[c-1][d].z<h.z+10&&(h.z=e[c-1][d].z/2+h.z/2)),c<i-1&&(e[c+1][d].x<h.x+10&&(h.x=e[c+1][d].x/2+h.x/2),e[c+1][d].y<h.y+10&&(h.y=e[c+1][d].y/2+h.y/2),e[c+1][d].z<h.z+10&&(h.z=e[c+1][d].z/2+h.z/2)),0<d&&(e[c][d-1].x<h.x+10&&(h.x=e[c][d-1].x/2+h.x/2),e[c][d-1].y<h.y+10&&(h.y=e[c][d-1].y/2+h.y/2),e[c][d-1].z<h.z+10&&(h.z=e[c][d-1].z/2+h.z/2)),d<o-1&&(e[c][d+1].x<h.x+10&&(h.x=e[c][d+1].x/2+h.x/2),e[c][d+1].y<h.y+10&&(h.y=e[c][d+1].y/2+h.y/2),e[c][d+1].z<h.z+10&&(h.z=e[c][d+1].z/2+h.z/2))),r[s+0]=0|h.x,r[s+1]=0|h.y,r[s+2]=0|h.z,r[s+3]=255,s+=4}else for(c=0;c<i;c++)for(d=0;d<o;d++)h=e[c][d],10<i&&10<o&&(0<c&&e[c-1][d]<h+10&&(h=e[c-1][d]/2+h/2),c<i-1&&e[c+1][d]<h+10&&(h=e[c+1][d]/2+h/2),0<d&&e[c][d-1]<h+10&&(h=e[c][d-1]/2+h/2),d<o-1&&e[c][d+1]<h+10&&(h=e[c][d+1]/2+h/2)),r[s+3]=0|Math.min(230,255-h),s+=4;return n.putImageData(a,0,0),u?t.toDataURL("image/jpeg",.9):t.toDataURL()}}();!function(){var t=document.createElement("canvas"),n=t.getContext("2d")}(),d.prototype={ka:function(t,n){var e=this,i=new Image;e.ready=!1,i.onload=function(){var t=i.width,o=i.height;e.ready=!0,e.canvas.width=t,e.canvas.height=o,e.context.drawImage(i,0,0),n&&n()},i.src=t},V:function(t,n){return this.ready?(n=58-(n/=12)|0,t=92+(t/=12)|0,25*(255-this.context.getImageData(n,t,1,1).data[0])):0}},function(){for(var t=0,n=["ms","moz","webkit","o"],e=0;e<n.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[n[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n[e]+"CancelAnimationFrame"]||window[n[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var e=(new Date).getTime(),i=Math.max(0,16-(e-t)),o=window.setTimeout(function(){n(e+i)},i);return t=e+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),window.onload=function(){function t(t){var n="keydown"==t.type;switch(t.keyCode){case 87:i=n;break;case 83:o=n;break;case 65:a=n;break;case 68:r=n;break;case 32:s=n}}function n(){w.Z(.5/Math.tan(6.981317)*Math.min(innerWidth,innerHeight))}function e(t){t=t-M||0,requestAnimationFrame(e),r?z.b=Math.min(z.b+.2,5):a?z.b=Math.max(z.b-.2,-5):0<z.b?z.b=Math.max(z.b-.2,0):0>z.b&&(z.b=Math.min(z.b+.2,0)),z.f=i?Math.min(z.f+.2,5):o?Math.max(z.f-.2,-5):0<z.f?Math.max(z.f-.2,0):0>z.f?Math.min(z.f+.2,0):0;var n=.0174532925*w.u.rotation.y,c=z.position.x-Math.sin(n)*z.f-Math.cos(n)*z.b,n=z.position.z+Math.cos(n)*z.f-Math.sin(n)*z.b,d=m.V(c,n);0!==z.f||0!==z.b||0!==z.B?(u&&(u=clearTimeout(u)),g&&(x.className="hide",g=!1)):u||(u=setTimeout(function(){x.className="",g=!0},4e3)),60<d-z.position.y?(z.f=0,z.b=0):(z.position.x=c,z.position.z=n),c=m.V(z.position.x,z.position.z),z.position.y>c?z.position.y<c+9?(z.position.y=c,z.b/=1.3,z.f/=1.3):z.B=Math.min(40,Math.max(-12,z.B+.75)):z.position.y>c-9?z.position.y=c:(z.B=-5,z.f/=1.1,z.b/=1.1),z.position.y===c&&(z.B=0,s&&(z.B=-12)),c=Math.cos(t/250)*z.f/10,t=Math.sin(t/500)*z.f/2/10,z.position.y-=z.B,v.rotation=z.rotation,v.rotation.x+=c,v.rotation.y+=t,v.position.x=z.position.x,v.position.y=z.position.y+275,v.position.z=z.position.z,w.update(),v.rotation.x-=c,v.rotation.y-=t}var i,o,a,r,s,u,f=document.getElementById("loading"),y=document.getElementById("viewport"),x=document.getElementById("instructions"),m=new d,g=!0;f.style.display="none","requestPointerLock"in document.body&&(document.body.onclick=function(){this.requestPointerLock()}),window.va&&(debugUI.onchange=function(){l.T(w.A,!1),w.A.update(!0)});var w=new c(y),v=w.u,z={position:p.create(300,500,-1730),rotation:p.create(0,270,0),f:0,B:0,b:0};h(w.A),s=r=a=o=i=!1,m.ka("images/map.png",function(){var t;x.className="",y.className="",g=!0,document.addEventListener("mousemove",function(n){!n.altKey&&t&&(n.movementX||n.movementY?(z.rotation.y+=n.movementX,z.rotation.x-=n.movementY):(z.rotation.x-=(n.pageY-t.y)/2,z.rotation.y+=(n.pageX-t.x)/2),z.rotation.x=Math.max(Math.min(z.rotation.x,90),-90)),t={x:n.pageX,y:n.pageY}},!1),e()}),document.addEventListener("keydown",t,!1),document.addEventListener("keyup",t,!1),n(),window.addEventListener("resize",n),l.T(w.A),w.A.update(!0);var M=new Date}}();